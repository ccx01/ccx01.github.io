require=function e(t,i,o){function n(s,h){if(!i[s]){if(!t[s]){var c="function"==typeof require&&require;if(!h&&c)return c(s,!0);if(a)return a(s,!0);var l=new Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var d=i[s]={exports:{}};t[s][0].call(d.exports,function(e){var i=t[s][1][e];return n(i?i:e)},d,d.exports,e,t,i,o)}return i[s].exports}for(var a="function"==typeof require&&require,s=0;s<o.length;s++)n(o[s]);return n}({control:[function(e,t,i){"use strict";cc._RFpush(t,"6563dvXC0VKMJPca0YJZGGn","control"),cc.Class({"extends":cc.Component,properties:{athena:{"default":null,type:cc.Node}},setInputControl:function(){},onLoad:function(){},update:function(e){}}),cc._RFpop()},{}],enemyHit:[function(e,t,i){"use strict";cc._RFpush(t,"7ef92yYivpIxpVyCocW1mt5","enemyHit"),cc.Class({"extends":cc.Component,properties:{damage:0,lie:!1},onCollisionEnter:function(e,t){if(Math.abs(e.node.zIndex-t.node.parent.zIndex)<20){var i=-Math.abs(t.node.parent.scaleX)/t.node.parent.scaleX;e.node.getComponent("player").hurt(i,this.damage,this.lie),t.node.parent.getComponent("enemy").hitEffectPrefabShow()}},onCollisionStay:function(e,t){},onCollisionExit:function(e,t){}}),cc._RFpop()},{}],enemy:[function(e,t,i){"use strict";cc._RFpush(t,"231aeiMgehBv4OsoEAeD58n","enemy"),cc.Class({"extends":cc.Component,properties:{anim:cc.Animation,xMaxSpeed:0,yMaxSpeed:0,canMove:!0,comboNext:0,comboLock:!1,state:"stand",skillPool:[],hp:10,hpMax:10,hpLen:{"default":null,type:cc.Node},playerHit:{"default":null},hitEffect:{"default":null},playerHitPrefab:{"default":null,type:cc.Prefab},hitEffectPrefab:{"default":null,type:cc.Prefab},hitAudio:{"default":null,url:cc.AudioClip}},moveOffset:function(e){this.node.scaleX<0&&(e*=-1),this.node.x+=e},combo:function(){this.skillPool.push("combo"+this.comboNext),this.comboNext++,4===this.comboNext&&(this.comboNext=0),this.skill()},comboEnd:function(){this.skillPool=[]},skill:function(){this.comboLock||(this.xSpeed=0,this.ySpeed=0,this.skillPool.length>0?(this.canMove=!1,this.comboLock=!0,this.statePool(this.skillPool[0]),this.skillPool.shift()):(this.canMove=!0,this.comboNext=0,this.comboLock=!1,this.statePool("stand")))},hitPrefabShow:function(e,t,i,o,n,a,s){this.playerHit=cc.instantiate(this.playerHitPrefab),this.node.addChild(this.playerHit),this.playerHit.setPosition(e,t),this.playerHit.getComponents(cc.Collider)[0].size.width=i,this.playerHit.getComponents(cc.Collider)[0].size.height=o,this.playerHit.getComponents("enemyHit")[0].damage=1,this.playerHit.getComponents("enemyHit")[0].lie=n||this.playerHit.getComponents("enemyHit")[0].lie,this.ex=a||e,this.ey=s||t},hitPrefabHide:function(){this.playerHit.destroy()},hitEffectPrefabShow:function(){this.hitEffect=cc.instantiate(this.hitEffectPrefab),this.node.addChild(this.hitEffect),this.hitEffect.setPosition(this.ex,this.ey),cc.audioEngine.playEffect(this.hitAudio,!1)},move:function(e,t){this.canMove?(this.xSpeed=e,this.ySpeed=t,0==e&&0==t?this.statePool("stand"):(e>0?this.node.scaleX=Math.abs(this.node.scaleX):this.node.scaleX=-Math.abs(this.node.scaleX),this.statePool("walk"))):(this.xSpeed=0,this.ySpeed=0)},hurt:function(e,t,i){this.canMove=!1,this.xSpeed=0,this.ySpeed=0,this.hp-=t,this.hp=Math.max(0,this.hp),this.hpLen.width=this.hp/this.hpMax*100,i||0==this.hp?(this.statePool("lie"),this.node.scaleX=e*Math.abs(this.node.scaleX),this.xSpeed=-500*e):(this.statePool("hurt"),this.node.scaleX=e*Math.abs(this.node.scaleX),this.node.x-=10*e)},onGround:function(){this.xSpeed=0,this.statePool("onground"),0==this.hp&&(this.node.destroy(),this.game.enemyShow(-600,0),this.game.win++,this.game.win>10&&(alert("you win!"),cc.game.pause()))},invincible:function(e){this.node.getComponents(cc.Collider)[0].enabled=e},statePool:function(e){if(this.state!=e)switch(this.state=e,e){case"combo0":this.anim.play("athena-c0");break;case"combo1":this.anim.play("athena-c1");break;case"combo2":this.anim.play("athena-c2");break;case"combo3":this.anim.play("athena-c3");break;case"stand":this.anim.play("athena-stand");break;case"walk":this.anim.play("athena-walk");break;case"hurt":this.anim.play("athena-hurt");break;case"lie":this.anim.play("athena-lie");break;case"onground":this.anim.play("athena-ground")}},AI:function(){if(Math.abs(this.game.athena.x-this.node.x)<50&&Math.abs(this.game.athena.y-this.node.y)<50)return void this.statePool("combo0");if(!(Math.random()<.95))if(Math.random()>.8){var e,t;e=this.game.athena.x>this.node.x?this.xMaxSpeed:-this.xMaxSpeed,t=this.game.athena.y>this.node.y?this.yMaxSpeed:-this.yMaxSpeed,this.move(e,t)}else this.move(0,0)},onLoad:function(){this.xSpeed=0,this.ySpeed=0,this.anim.on("finished",function(){this.comboLock=!1,this.skill()},this)},update:function(e){this.AI(),this.node.x+=this.xSpeed*e,this.node.y+=this.ySpeed*e,this.node.zIndex=1e3-this.node.y,this.node.y=Math.min(Math.max(this.node.y,-170),-30)}}),cc._RFpop()},{}],game:[function(e,t,i){"use strict";cc._RFpush(t,"f9bc2XoIP9IyJguRRKMcXjs","game"),cc.Class({"extends":cc.Component,properties:{win:0,athena:{"default":null,type:cc.Node},enemyPrefab:{"default":null,type:cc.Prefab}},enemyShow:function(e,t){var i=cc.instantiate(this.enemyPrefab);i.getComponent("enemy").game=this,this.node.addChild(i),i.setPosition(e,t)},onLoad:function(){this.enemyShow(100,-60),this.enemyShow(90,-80);var e=cc.director.getCollisionManager();e.enabled=!0},update:function(e){this.athena.x=Math.min(Math.max(this.athena.x,-400),400),this.athena.y=Math.min(Math.max(this.athena.y,-170),-30)}}),cc._RFpop()},{}],hitEffect:[function(e,t,i){"use strict";cc._RFpush(t,"11a5cdjRG9LMIddY2BTY+Ye","hitEffect"),cc.Class({"extends":cc.Component,properties:{anim:cc.Animation},onLoad:function(){this.anim.play("hit-effect")},hide:function(){this.destroy()}}),cc._RFpop()},{}],playerHit:[function(e,t,i){"use strict";cc._RFpush(t,"bb88b+QKO1CeJAhCuJWwqS9","playerHit"),cc.Class({"extends":cc.Component,properties:{damage:0,lie:!1},onCollisionEnter:function(e,t){if(Math.abs(e.node.zIndex-t.node.parent.zIndex)<20){var i=-Math.abs(t.node.parent.scaleX)/t.node.parent.scaleX;e.node.getComponent("enemy").hurt(i,this.damage,this.lie),t.node.parent.getComponent("player").hitEffectPrefabShow()}},onCollisionStay:function(e,t){},onCollisionExit:function(e,t){}}),cc._RFpop()},{}],player:[function(e,t,i){"use strict";cc._RFpush(t,"b45613Jj2hEm7TPecWSBx6v","player"),cc.Class({"extends":cc.Component,properties:{anim:cc.Animation,xMaxSpeed:0,yMaxSpeed:0,canMove:!0,comboNext:0,comboLock:!1,state:"stand",skillPool:[],hp:10,hpMax:10,ex:0,ey:0,playerHit:{"default":null},hitEffect:{"default":null},hpBar:{"default":null,type:cc.ProgressBar},controller:{"default":null,type:cc.Node},joypadPanel:{"default":null,type:cc.Node},joypad:{"default":null,type:cc.Node},playerHitPrefab:{"default":null,type:cc.Prefab},hitEffectPrefab:{"default":null,type:cc.Prefab},hitAudio:{"default":null,url:cc.AudioClip}},moveOffset:function(e){this.node.scaleX<0&&(e*=-1),this.node.x+=e},combo:function(){this.skillPool.push("combo"+this.comboNext),this.comboNext++,this.comboNext>6&&(this.comboNext=0),this.skill()},hitPrefabShow:function(e,t,i,o,n,a,s){this.playerHit=cc.instantiate(this.playerHitPrefab),this.node.addChild(this.playerHit),this.playerHit.setPosition(e,t),this.playerHit.getComponents(cc.Collider)[0].size.width=i,this.playerHit.getComponents(cc.Collider)[0].size.height=o,this.playerHit.getComponents("playerHit")[0].damage=1,this.playerHit.getComponents("playerHit")[0].lie=n||this.playerHit.getComponents("playerHit")[0].lie,this.ex=a||e,this.ey=s||t},hitPrefabHide:function(){this.playerHit.destroy()},hitEffectPrefabShow:function(){this.hitEffect=cc.instantiate(this.hitEffectPrefab),this.node.addChild(this.hitEffect),this.hitEffect.setPosition(this.ex,this.ey),cc.audioEngine.playEffect(this.hitAudio,!1)},skillStart:function(){this.comboLock=!0,this.canMove=!1},skillEnd:function(){this.canMove=!0,this.comboLock=!1,this.skill()},comboEnd:function(){this.skillPool=[],this.skill()},skill:function(){this.comboLock||(this.xSpeed=0,this.ySpeed=0,this.skillPool.length>0?(this.statePool(this.skillPool[0]),this.skillPool.shift()):(this.comboNext=0,this.statePool("stand")))},hurt:function(e,t,i){this.canMove=!1,this.xSpeed=0,this.ySpeed=0,this.hp-=t,this.hp=Math.max(0,this.hp),this.hpBar.progress=this.hp/this.hpMax,i||0==this.hp?(this.statePool("lie"),this.node.scaleX=e*Math.abs(this.node.scaleX),this.xSpeed=-500*e):(this.statePool("hurt"),this.node.scaleX=e*Math.abs(this.node.scaleX),this.node.x-=10*e)},onGround:function(){this.xSpeed=0,this.statePool("onground"),0==this.hp&&(alert("you loseï¼"),cc.game.pause())},move:function(e,t){this.canMove?(this.xSpeed=e,this.ySpeed=t,0==e&&0==t?this.statePool("stand"):(e>0?this.node.scaleX=Math.abs(this.node.scaleX):e<0&&(this.node.scaleX=-Math.abs(this.node.scaleX)),this.statePool("walk"))):(this.xSpeed=0,this.ySpeed=0)},statePool:function(e){if(this.state!=e)switch(this.state=e,e){case"combo0":this.anim.play("athena-c0");break;case"combo1":this.anim.play("athena-c1");break;case"combo2":this.anim.play("athena-c2");break;case"combo3":this.anim.play("athena-c3");break;case"combo4":this.anim.play("athena-c4");break;case"combo5":this.anim.play("athena-c5");break;case"stand":this.anim.play("athena-stand");break;case"walk":this.anim.play("athena-run");break;case"hurt":this.anim.play("athena-hurt");break;case"lie":this.anim.play("athena-lie");break;case"onground":this.anim.play("athena-ground")}},setInputControl:function(){var e=this,t=this.controller;t.zIndex=3e3;var i=this.joypad,o=this.joypadPanel,n=!1;cc.eventManager.addListener({event:cc.EventListener.KEYBOARD,onKeyPressed:function(t,i){switch(t){case cc.KEY.a:e.xSpeed=-e.xMaxSpeed,e.move(e.xSpeed,e.ySpeed);break;case cc.KEY.d:e.xSpeed=e.xMaxSpeed,e.move(e.xSpeed,e.ySpeed);break;case cc.KEY.w:e.ySpeed=e.yMaxSpeed,e.move(e.xSpeed,e.ySpeed);break;case cc.KEY.s:e.ySpeed=-e.yMaxSpeed,e.move(e.xSpeed,e.ySpeed);break;case cc.KEY.j:e.combo()}},onKeyReleased:function(t,i){switch(t){case cc.KEY.a:case cc.KEY.d:e.xSpeed=0;break;case cc.KEY.w:case cc.KEY.s:e.ySpeed=0}e.move(e.xSpeed,e.ySpeed)}},e.node);var a,s,h,c,l,d,p={event:cc.EventListener.TOUCH_ONE_BY_ONE,onTouchBegan:function(e,t){if(!n)return a=e.getLocationX(),s=e.getLocationY(),a>0&&a<300&&s>0&&s<300&&(n=!0,o.x=a,o.y=s),!0},onTouchMoved:function(t,o){n&&(h=t.getLocationX(),c=t.getLocationY(),h>a?l=e.xMaxSpeed:h<a&&(l=-e.xMaxSpeed),c>s?d=e.yMaxSpeed:c<s&&(d=-e.yMaxSpeed),l=l||0,d=d||0,e.move(l,d),i.x=Math.min(40,Math.max(.5*(h-a),-40)),i.y=Math.min(40,Math.max(.5*(c-s),-40)))},onTouchEnded:function(t,i){n&&(e.move(0,0),n=!1)},onTouchCancelled:function(t,i){n&&(e.move(0,0),n=!1)}};cc.eventManager.addListener(p,this.node)},onLoad:function(){this.xSpeed=0,this.ySpeed=0,this.setInputControl()},update:function(e){this.node.x+=this.xSpeed*e,this.node.y+=this.ySpeed*e,this.node.zIndex=1e3-this.node.y}}),cc._RFpop()},{}]},{},["hitEffect","enemy","control","enemyHit","player","playerHit","game"]);